<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News & Announcements - Manipur State Museum</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <h1>Manipur State Museum</h1>
                </div>
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="/">Home</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/collections">Collections</a></li>
                    <li><a href="/exhibitions">Exhibitions</a></li>
                    <li><a href="/visitor-info">Visit</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/news" class="active">News</a></li>
                    <li><a href="/contact">Contact</a></li>
                    <li><a href="/admin" class="btn-admin">Admin</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section style="background: linear-gradient(135deg, #d97706 0%, #ea580c 100%); padding: 4rem 0; text-align: center; color: white;">
        <div class="container">
            <h1 style="font-size: 3rem; font-weight: 700; margin-bottom: 1rem;">News & Announcements</h1>
            <p style="font-size: 1.25rem;">Stay updated with the latest happenings at Manipur State Museum</p>
        </div>
    </section>

    <!-- News Categories Filter -->
    <section style="padding: 2rem 0 0 0;">
        <div class="container">
            <div class="filter-bar">
                <div class="filter-group">
                    <div class="search-box">
                        <span class="search-icon">üîç</span>
                        <input type="text" id="newsSearchInput" placeholder="Search news articles...">
                    </div>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-category="All" onclick="filterNews('All')">All News</button>
                        <button class="filter-btn" data-category="Announcement" onclick="filterNews('Announcement')">Announcements</button>
                        <button class="filter-btn" data-category="Press Release" onclick="filterNews('Press Release')">Press Releases</button>
                        <button class="filter-btn" data-category="Event" onclick="filterNews('Event')">Events</button>
                        <button class="filter-btn" data-category="General" onclick="filterNews('General')">General</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- News Content Section -->
    <section style="padding: 2rem 0 4rem 0;">
        <div class="container">
            <!-- News Container -->
            <div id="newsContainer">
                <div class="loading">Loading news articles...</div>
            </div>

            <!-- Newsletter Subscription -->
            <div class="card" style="margin-top: 3rem; background: linear-gradient(135deg, #fff7ed 0%, #fed7aa 100%); border-left: 5px solid var(--primary-color);">
                <h2 style="margin-bottom: 1rem;">üìß Subscribe to Our Newsletter</h2>
                <p style="color: var(--text-light); margin-bottom: 1.5rem;">Stay informed about museum updates, upcoming exhibitions, and special events. Subscribe to receive our monthly newsletter.</p>
                <form id="newsletterForm" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <input 
                        type="email" 
                        name="email" 
                        placeholder="Enter your email address" 
                        required
                        style="flex: 1; min-width: 250px; padding: 0.875rem 1rem; border: 2px solid var(--border); border-radius: 8px; font-size: 1rem;"
                    >
                    <button type="submit" class="btn btn-primary">Subscribe</button>
                </form>
            </div>

            <!-- Press Contact -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 2rem;">
                <div class="card">
                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;">üì∞ Press Inquiries</h3>
                    <p style="color: var(--text-light); margin-bottom: 1rem;">For media inquiries and press releases, please contact our communications office.</p>
                    <p><strong>Email:</strong> press@manipurmuseum.gov.in</p>
                    <p><strong>Phone:</strong> +91-385-2222XXX (Ext. 123)</p>
                </div>

                <div class="card">
                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;">üìÖ Event Calendar</h3>
                    <p style="color: var(--text-light); margin-bottom: 1rem;">Check out our upcoming events, workshops, and cultural programs.</p>
                    <a href="/events" class="btn btn-secondary" style="display: inline-block; margin-top: 0.5rem;">View Events Calendar</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>Manipur State Museum</h3>
                    <p>Preserving and showcasing the rich cultural heritage of Manipur since 1969.</p>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/about">About Us</a></li>
                        <li><a href="/collections">Collections</a></li>
                        <li><a href="/exhibitions">Exhibitions</a></li>
                        <li><a href="/events">Events</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Visit Us</h4>
                    <ul>
                        <li>Polo Ground, Imphal West</li>
                        <li>Manipur - 795001</li>
                        <li>Phone: +91-385-2222XXX</li>
                        <li>Email: info@manipurmuseum.gov.in</li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Opening Hours</h4>
                    <ul>
                        <li>Tuesday - Sunday</li>
                        <li>10:00 AM - 4:30 PM</li>
                        <li>Monday: Closed</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Manipur State Museum. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="/js/main.js"></script>
    <script>
        // Global variable to store all news articles
        let allNewsArticles = [];
        let currentCategory = 'All';

        // Load news articles on page load
        async function loadNewsArticles() {
            try {
                const response = await fetch('/api/news');
                const data = await response.json();
                
                const container = document.getElementById('newsContainer');
                
                if (data.success && data.data.length > 0) {
                    allNewsArticles = data.data;
                    displayNews(allNewsArticles);
                } else {
                    container.innerHTML = `
                        <div class="card" style="text-align: center; padding: 3rem;">
                            <div style="font-size: 4rem; margin-bottom: 1rem;">üì∞</div>
                            <h2 style="margin-bottom: 1rem;">No News Articles Yet</h2>
                            <p style="color: var(--text-light);">Check back soon for the latest updates and announcements from Manipur State Museum.</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading news:', error);
                document.getElementById('newsContainer').innerHTML = `
                    <div class="card" style="text-align: center; padding: 3rem; background: #fee2e2; border-left: 4px solid var(--error);">
                        <p style="color: var(--error); font-weight: 600;">Error loading news articles. Please try again later.</p>
                    </div>
                `;
            }
        }

        // Display news articles
        function displayNews(articles) {
            const container = document.getElementById('newsContainer');
            
            if (articles.length === 0) {
                container.innerHTML = `
                    <div class="card" style="text-align: center; padding: 3rem;">
                        <p style="color: var(--text-light); font-size: 1.125rem;">No articles found matching your criteria.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = articles.map((news, index) => {
                const categoryColor = getCategoryColor(news.category);
                const publishDate = news.publishDate ? formatDate(news.publishDate) : 'Date not available';
                
                return `
                    <article class="card" style="margin-bottom: 2rem; transition: transform 0.3s, box-shadow 0.3s;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 12px 24px rgba(0,0,0,0.15)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">
                        ${news.image ? `
                            <img 
                                src="${news.image}" 
                                alt="${news.title}" 
                                style="width: 100%; height: 350px; object-fit: cover; border-radius: 8px; margin-bottom: 1.5rem;"
                                onerror="this.style.display='none'"
                            >
                        ` : ''}
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 1rem;">
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <span style="background: ${categoryColor}; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                                    ${news.category || 'General'}
                                </span>
                                <span style="color: var(--text-light); font-size: 0.875rem;">
                                    üìÖ ${publishDate}
                                </span>
                            </div>
                            ${news.views ? `
                                <span style="color: var(--text-light); font-size: 0.875rem;">
                                    üëÅÔ∏è ${news.views} views
                                </span>
                            ` : ''}
                        </div>

                        <h2 style="font-size: 1.875rem; margin-bottom: 1rem; color: var(--text-dark); line-height: 1.3;">
                            ${news.title}
                        </h2>

                        <p style="color: var(--text-light); font-size: 1.125rem; margin-bottom: 1.5rem; line-height: 1.6; font-weight: 500;">
                            ${news.excerpt}
                        </p>

                        <div style="color: var(--text-dark); font-size: 1rem; line-height: 1.8; margin-bottom: 1.5rem;">
                            ${news.content}
                        </div>

                        <div style="padding-top: 1.5rem; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                            <button onclick="shareArticle('${news.title.replace(/'/g, "\\'")}', '${news._id}')" class="btn btn-secondary" style="padding: 0.625rem 1.5rem;">
                                üì§ Share
                            </button>
                            ${news.author ? `
                                <span style="color: var(--text-light); font-size: 0.875rem;">
                                    ‚úçÔ∏è By ${news.author}
                                </span>
                            ` : ''}
                        </div>
                    </article>
                `;
            }).join('');
        }

        // Get category color
        function getCategoryColor(category) {
            const colors = {
                'Announcement': '#d97706',
                'Press Release': '#0ea5e9',
                'Event': '#10b981',
                'General': '#6b7280'
            };
            return colors[category] || '#6b7280';
        }

        // Filter news by category
        function filterNews(category) {
            currentCategory = category;
            
            // Update active button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.category === category) {
                    btn.classList.add('active');
                }
            });

            // Filter and display
            const searchQuery = document.getElementById('newsSearchInput').value.toLowerCase();
            let filtered = allNewsArticles;

            if (category !== 'All') {
                filtered = filtered.filter(article => article.category === category);
            }

            if (searchQuery) {
                filtered = filtered.filter(article => 
                    article.title.toLowerCase().includes(searchQuery) ||
                    article.excerpt.toLowerCase().includes(searchQuery) ||
                    article.content.toLowerCase().includes(searchQuery)
                );
            }

            displayNews(filtered);
        }

        // Search functionality
        document.getElementById('newsSearchInput')?.addEventListener('input', (e) => {
            const searchQuery = e.target.value.toLowerCase();
            let filtered = allNewsArticles;

            if (currentCategory !== 'All') {
                filtered = filtered.filter(article => article.category === currentCategory);
            }

            if (searchQuery) {
                filtered = filtered.filter(article => 
                    article.title.toLowerCase().includes(searchQuery) ||
                    article.excerpt.toLowerCase().includes(searchQuery) ||
                    article.content.toLowerCase().includes(searchQuery)
                );
            }

            displayNews(filtered);
        });

        // Share article function
        function shareArticle(title, id) {
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: `Check out this article from Manipur State Museum: ${title}`,
                    url: window.location.href + '#article-' + id
                }).catch(err => console.log('Error sharing:', err));
            } else {
                // Fallback: Copy to clipboard
                const url = window.location.href + '#article-' + id;
                navigator.clipboard.writeText(url).then(() => {
                    showNotification('Link copied to clipboard!', 'success');
                }).catch(() => {
                    showNotification('Unable to copy link', 'error');
                });
            }
        }

        // Newsletter subscription
        document.getElementById('newsletterForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = e.target.email.value;

            try {
                // You can implement the actual subscription logic here
                // For now, we'll just show a success message
                showNotification('Thank you for subscribing to our newsletter!', 'success');
                e.target.reset();
            } catch (error) {
                console.error('Newsletter subscription error:', error);
                showNotification('Subscription failed. Please try again.', 'error');
            }
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            loadNewsArticles();
        });

        // Smooth scroll to article on hash change
        if (window.location.hash) {
            setTimeout(() => {
                const element = document.querySelector(window.location.hash);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth' });
                }
            }, 1000);
        }
    </script>

    <style>
        /* Additional styles for news page */
        article.card {
            scroll-margin-top: 100px;
        }

        /* Responsive adjustments for news articles */
        @media (max-width: 768px) {
            article.card h2 {
                font-size: 1.5rem !important;
            }

            article.card img {
                height: 250px !important;
            }
        }

        /* Print styles */
        @media print {
            .navbar,
            .footer,
            .filter-bar,
            button {
                display: none !important;
            }

            article.card {
                page-break-inside: avoid;
                box-shadow: none !important;
                border: 1px solid #e5e7eb;
            }
        }

        /* Loading animation */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .loading {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</body>
</html>
